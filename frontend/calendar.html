<!DOCTYPE html>
<html>

<head>

<title>ìº˜ë¦°ë”</title>

<style>

body{

text-align:center;
font-family:sans-serif;

}

.calendar{

display:grid;
grid-template-columns:repeat(7,1fr);

gap:10px;

margin:40px;

}

.day{

padding:20px;

background:#ffeef3;

border-radius:10px;

cursor:pointer;

}

#recordBox{

display:none;

margin:20px;

}

img{

max-width:200px;

margin-top:10px;

}

</style>

</head>

<body>

<h1>ğŸ“… ìš°ë¦¬ì˜ ë‚ ì§œ</h1>

<div class="calendar" id="calendar"></div>

<div id="recordBox">

<h3 id="selectedDate"></h3>

<input type="file" id="photo">

<br><br>

<textarea id="text"
placeholder="ì˜¤ëŠ˜ ê¸°ë¡ ì‘ì„±"
rows="4"
cols="30"></textarea>

<br><br>

<button onclick="saveRecord()">ì €ì¥</button>

<div id="preview"></div>

</div>

<script>

const calendar=document.getElementById("calendar");
let currentDay=null;

for(let i=1;i<=30;i++){

const day=document.createElement("div");

day.className="day";

let text=i+"ì¼";

// ê¸°ë¡ í™•ì¸
const record=localStorage.getItem("record_"+i);

if(record){

text+=" â¤ï¸";

}

// ì¼ì • í™•ì¸
const schedule=localStorage.getItem("schedule_"+i);

if(schedule){

const data=JSON.parse(schedule);

text+=" "+data.emoji;

}

day.innerText=text;

day.addEventListener("click",()=>{

currentDay=i;

showMenu();

});

calendar.appendChild(day);

}

function saveRecord(){

const text=document.getElementById("text").value;

const photo=document.getElementById("photo").files[0];

if(photo){

const reader=new FileReader();

reader.onload=function(){

localStorage.setItem(

"record_"+currentDay,

JSON.stringify({

text:text,

image:reader.result

})

);

alert("ì €ì¥ ì™„ë£Œ!");

loadRecord();

};

reader.readAsDataURL(photo);

}else{

localStorage.setItem(

"record_"+currentDay,

JSON.stringify({

text:text

})

);

alert("ì €ì¥ ì™„ë£Œ!");

}

}

function loadRecord(){

const data=localStorage.getItem(

"record_"+currentDay

);

const preview=document.getElementById("preview");

preview.innerHTML="";

document.getElementById("text").value="";

if(data){

const record=JSON.parse(data);

document.getElementById("text").value=

record.text || "";

if(record.image){

const img=document.createElement("img");

img.src=record.image;

preview.appendChild(img);

}

}

}

function showMenu(){

const record=

localStorage.getItem(

"record_"+currentDay

);

const schedule=

localStorage.getItem(

"schedule_"+currentDay

);

// â­ ì´ë¯¸ ìˆëŠ” ê²½ìš° ë³´ê¸°
if(record || schedule){

showDetail();

return;

}

dateDiv.addEventListener("click", () => {

  selectedDate = date;

  modal.classList.remove("hidden");

  modalDate.textContent =
    `${currentYear}-${currentMonth+1}-${date}`;

  const saved = diaryData[selectedDate];

  if(saved){

    diaryText.value = saved.text;
    selectedEmoji = saved.emoji;

  }else{

    diaryText.value = "";
    selectedEmoji = "";

  }

});

}

function addSchedule(){

const emojiList=[

{emoji:"â¤ï¸",title:"ë°ì´íŠ¸"},

{emoji:"ğŸ‚",title:"ìƒì¼"},

{emoji:"âœˆï¸",title:"ì—¬í–‰"},

{emoji:"ğŸ¿",title:"ì˜í™”"}

];

let message="ì¼ì • ì„ íƒí•˜ì„¸ìš”\n";

emojiList.forEach((e,index)=>{

message+=(index+1)+". "+e.emoji+" "+e.title+"\n";

});

const choice=prompt(message);

const selected=emojiList[choice-1];

if(!selected)return;

localStorage.setItem(

"schedule_"+currentDay,

JSON.stringify(selected)

);

alert("ì¼ì • ì €ì¥!");

location.reload();

}

function showDetail(){

let message=currentDay+"ì¼\n";

const schedule=

localStorage.getItem(

"schedule_"+currentDay

);

if(schedule){

const data=JSON.parse(schedule);

message+=data.emoji+" "+data.title+"\n";

}

const record=

localStorage.getItem(

"record_"+currentDay

);

if(record){

const data=JSON.parse(record);

message+="\nê¸°ë¡:\n"+(data.text||"");

}

const edit=confirm(

message+"\n\nìˆ˜ì •í• ê¹Œìš”?"

);

if(edit){

document.getElementById("recordBox").style.display="block";

document.getElementById("selectedDate").innerText=

currentDay+"ì¼ ê¸°ë¡";

loadRecord();

}

}

saveBtn.addEventListener("click",()=>{

  if(diaryData[date]){

  const emoji =
    document.createElement("div");

  emoji.textContent =
    diaryData[date].emoji;

  dateDiv.appendChild(emoji);

}

  localStorage.setItem(
    "diary",
    JSON.stringify(diaryData)
  );

  modal.classList.add("hidden");

  renderCalendar();

});

</script>

</body>

</html>